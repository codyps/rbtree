#! /bin/bash

LINUX_GIT=$HOME/g/linux

fh () {
	echo fh $1 $2 1>&2
	( cd "$1" && git show --pretty=format:%H "$2" | head; )
}

files=( include/linux/rbtree.h include/linux/rbtree_augmented.h \
	lib/rbtree.c Documentation/rbtree.txt )

for i in "${files[@]}"; do
	cp $LINUX_GIT/$i .
	fh "$LINUX_GIT" "$i" > $(basename $i).version
done

sed -i '/^EXPORT_SYMBOL(.*);$/d' rbtree.c
sed -i '/^#include <linux.*>$/d' rbtree.c
